<!DOCTYPE html>
<!-- saved from url=(0065)https://s0h4m-breachfinder.github.io/Machine_Learning_Roadmap_3d/ -->
<html lang="en" data-darkreader-proxy-injected="true" class="dark-mode"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Machine Learning Career Roadmap - Interactive 3D Graph</title>
    <link href="./Machine Learning Career Roadmap - Interactive 3D Graph_files/css2" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/3d-force-graph@1.77.0/dist/3d-force-graph.min.js" defer></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        :root {
            --font-primary: 'Poppins', sans-serif;
            --transition-speed: 0.3s ease-in-out;
            --border-radius-main: 16px;
            --border-radius-small: 8px;
            --bg-light: #e9eef2; --bg-glass-light: rgba(255, 255, 255, 0.7); --border-glass-light: rgba(220, 220, 220, 0.85);
            --text-primary-light: #2c3e50; --text-secondary-light: #566573;
            --accent-primary-light: #2980b9; --accent-secondary-light: #27ae60; --shadow-light: 0 6px 24px 0 rgba(0, 0, 0, 0.08);
            --bg-dark: #1f2227; --bg-glass-dark: rgba(40, 43, 48, 0.7); --border-glass-dark: rgba(55, 58, 63, 0.85);
            --text-primary-dark: #ecf0f1; --text-secondary-dark: #aab8c2;
            --accent-primary-dark: #3498db; --accent-secondary-dark: #2ecc71; --shadow-dark: 0 8px 32px 0 rgba(0, 0, 0, 0.25);
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { background-color: var(--bg-current); color: var(--text-primary-current); transition: background-color var(--transition-speed), color var(--transition-speed); }
        body { font-family: var(--font-primary); line-height: 1.6; overflow-x: hidden; min-height: 100vh; color: inherit; background-color: inherit; }
        html.dark-mode {
            --bg-current: var(--bg-dark); --bg-glass-current: var(--bg-glass-dark); --border-glass-current: var(--border-glass-dark);
            --text-primary-current: var(--text-primary-dark); --text-secondary-current: var(--text-secondary-dark);
            --accent-primary-current: var(--accent-primary-dark); --accent-secondary-current: var(--accent-secondary-dark);
            --shadow-current: var(--shadow-dark);
        }
        html:not(.dark-mode) {
            --bg-current: var(--bg-light); --bg-glass-current: var(--bg-glass-light); --border-glass-current: var(--border-glass-light);
            --text-primary-current: var(--text-primary-light); --text-secondary-current: var(--text-secondary-light);
            --accent-primary-current: var(--accent-primary-light); --accent-secondary-current: var(--accent-secondary-light);
            --shadow-current: var(--shadow-light);
        }
        .page-wrapper { max-width: 1600px; margin: 0 auto; padding: 20px; }
        .page-header { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; padding: 15px 0; margin-bottom: 20px; gap: 20px; }
        .page-title { font-size: 2.2em; font-weight: 700; color: var(--accent-primary-current); letter-spacing: -0.5px; margin-right: auto; }
        .header-controls { display: flex; align-items: center; gap: 20px; }
        .dark-mode-toggle { display: flex; align-items: center; cursor: pointer; }
        .dark-mode-toggle input[type="checkbox"] { display: none; }
        .toggle-slider { width: 50px; height: 26px; background-color: #bdc3c7; border-radius: 26px; position: relative; transition: background-color var(--transition-speed); }
        .toggle-slider::before { content: ''; position: absolute; width: 22px; height: 22px; border-radius: 50%; background-color: white; top: 2px; left: 2px; transition: transform var(--transition-speed); box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .dark-mode-toggle input:checked + .toggle-slider { background-color: var(--accent-primary-current); }
        .dark-mode-toggle input:checked + .toggle-slider::before { transform: translateX(24px); }
        .toggle-icon { margin-left: 10px; font-size: 1.2em; color: var(--text-secondary-current); }
        html.dark-mode .toggle-icon { color: var(--accent-primary-current); }

        .content-section { background: var(--bg-glass-current); border: 1px solid var(--border-glass-current); border-radius: var(--border-radius-main); padding: 25px; margin-bottom: 30px; box-shadow: var(--shadow-current); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
        .content-section h3 { font-size: 1.5em; font-weight: 600; color: var(--accent-primary-current); margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid var(--accent-primary-current); }
        .content-section p, .content-section li { color: var(--text-secondary-current); font-size: 0.95em; margin-bottom: 10px; }
        .content-section strong { color: var(--text-primary-current); font-weight: 600; }
        #visNetwork { height: 80vh; width: 100%; border-radius: var(--border-radius-small); cursor: default; border: 1px solid var(--border-glass-current); position: relative; overflow: hidden; }
        .legend ul { list-style: none; padding: 0; display: grid; grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)); gap: 8px; }
        .legend li { color: var(--text-secondary-current); padding: 5px 0; font-size: 0.85em; }
        .legend-color-indicator { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 6px; vertical-align: middle; border: 1px solid rgba(120,120,120,0.3); }
        .legend-text { vertical-align: middle; }
        .accordion-item { margin-bottom: 15px; border-radius: var(--border-radius-small); overflow: hidden; border: 1px solid var(--border-glass-current); }
        .accordion-header { background-color: rgba(0,0,0,0.02); padding: 15px 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        html.dark-mode .accordion-header { background-color: rgba(255,255,255,0.03); }
        .accordion-header:hover { background-color: rgba(0,0,0,0.04); }
        html.dark-mode .accordion-header:hover { background-color: rgba(255,255,255,0.06); }
        .accordion-header strong { font-size: 1.1em; color: var(--text-primary-current); } /* This refers to accordion headers */
        .accordion-icon { font-size: 1em; color: var(--accent-primary-current); transition: transform var(--transition-speed); }
        .accordion-item.active .accordion-icon { transform: rotate(45deg); }
        .accordion-content { max-height: 0px; overflow: hidden; padding: 0 20px; background-color: transparent; transition: max-height 0.5s ease-out, padding var(--transition-speed); }
        .accordion-item.active .accordion-content { max-height: 1500px; padding: 20px; }
        .accordion-content ul { list-style-position: inside; padding-left: 5px; }
        .accordion-content ul li { margin-bottom: 8px; }
        .loading-message { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 1.2em; color: var(--text-secondary-current); text-align: center; padding: 20px; }
        
        /* Custom Graph Tooltip Styles */
        #graph-tooltip {
            display: none;
            position: absolute; /* Will be fixed in JS if it needs to be relative to body */
            background: var(--bg-glass-current);
            color: var(--text-primary-current);
            padding: 10px 15px;
            border-radius: var(--border-radius-small);
            box-shadow: var(--shadow-current);
            z-index: 10000; /* High z-index */
            pointer-events: none; /* Important so it doesn't interfere with graph events */
            max-width: 320px;
            font-size: 0.9em;
            border: 1px solid var(--border-glass-current);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            line-height: 1.4;
        }
        #graph-tooltip strong { /* This will style the main node name title in the tooltip */
            color: var(--accent-primary-current);
            display: block;
            margin-bottom: 5px;
            font-weight: 600; /* Ensure it's bold */
        }
        /* End Custom Graph Tooltip Styles */

        @media (max-width: 768px) {
            .page-title { font-size: 1.8em; margin-bottom: 10px; width:100%; text-align:center; }
            .header-controls { width: 100%; justify-content: center; }
            .content-section { padding: 20px; } .legend ul { grid-template-columns: 1fr; } #visNetwork { height: 65vh; }
            .accordion-header strong { font-size: 1em; }
        }
         @media (max-width: 480px) {
            #visNetwork { height: 60vh; }
        }

    </style>
<style type="text/css">.graph-info-msg {
  top: 50%;
  width: 100%;
  text-align: center;
  color: lavender;
  opacity: 0.7;
  font-size: 22px;
  position: absolute;
  font-family: Sans-serif;
}

.scene-container .clickable {
  cursor: pointer;
}

.scene-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.scene-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}</style><style type="text/css">.scene-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}</style></head>
<body class="vsc-initialized">
    <div class="page-wrapper">
        <header class="page-header">
            <h1 class="page-title">Machine Learning Roadmap (3D Interactive)</h1>
            <div class="header-controls">
                <label class="dark-mode-toggle" for="darkModeToggle" aria-label="Toggle dark mode">
                    <input type="checkbox" id="darkModeToggle">
                    <span class="toggle-slider"></span>
                    <i class="fas toggle-icon fa-sun" id="modeIcon"></i>
                </label>
            </div>
        </header>

        <section class="content-section" id="roadmap-visualization">
            <h3>Career Visualization (3D) - Click nodes to explore, hover for details!</h3>
            <div id="visNetwork" style="border: 1px solid rgba(55, 58, 63, 0.85); --darkreader-inline-border-top: var(--darkreader-border-373a3fd9, rgba(121, 112, 99, 0.85)); --darkreader-inline-border-right: var(--darkreader-border-373a3fd9, rgba(121, 112, 99, 0.85)); --darkreader-inline-border-bottom: var(--darkreader-border-373a3fd9, rgba(121, 112, 99, 0.85)); --darkreader-inline-border-left: var(--darkreader-border-373a3fd9, rgba(121, 112, 99, 0.85));" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><div style="position: relative;"><div><div class="scene-container" style="position: relative; width: 1517px; height: 672px;"><canvas data-engine="three.js r152" width="1365" height="604" style="display: block; touch-action: none; width: 1517px; height: 672px;" class="clickable"></canvas><div class="scene-nav-info">Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan</div></div></div><div class="graph-info-msg"></div></div></div>
        </section>

        <section class="content-section" id="legend-section">
            <h3>Legend</h3>
            <p>Node colors and shapes represent different categories in Machine Learning:</p>
             <ul class="legend">
                <li><span class="legend-color-indicator" style="background-color: rgb(160, 210, 219);"></span><span class="legend-text">Foundations</span></li>
                <li><span class="legend-color-indicator" style="background-color: rgb(247, 200, 224);"></span><span class="legend-text">Mathematics</span></li>
                <li><span class="legend-color-indicator" style="background-color: rgb(190, 225, 230);"></span><span class="legend-text">Data Science Core</span></li>
                <li><span class="legend-color-indicator" style="background-color: rgb(169, 223, 191);"></span><span class="legend-text">Core ML Models</span></li>
                <li><span class="legend-color-indicator" style="background-color: rgb(212, 160, 249);"></span><span class="legend-text">Deep Learning</span></li>
                <li><span class="legend-color-indicator" style="background-color: rgb(255, 179, 71);"></span><span class="legend-text">NLP</span></li>
                <li><span class="legend-color-indicator" style="background-color: rgb(135, 206, 235);"></span><span class="legend-text">Computer Vision</span></li>
                <li><span class="legend-color-indicator" style="background-color: rgb(255, 218, 185);"></span><span class="legend-text">Reinforcement Learning</span></li>
                <li><span class="legend-color-indicator" style="background-color: rgb(254, 200, 154);"></span><span class="legend-text">MLOps</span></li>
                <li><span class="legend-color-indicator" style="background-color: rgb(178, 186, 187);"></span><span class="legend-text">Tools & Libraries</span></li>
                <li><span class="legend-color-indicator" style="background-color: rgb(224, 187, 228);"></span><span class="legend-text">Courses/Certs</span></li>
                <li><span class="legend-color-indicator" style="background-color: rgb(199, 206, 234);"></span><span class="legend-text">General Concepts</span></li>
            </ul>
        </section>

        <section class="content-section" id="learning-path">
            <h3>Recommended Learning Path</h3>
            <div class="accordion">
                <div class="accordion-item">
                    <div class="accordion-header"><strong>Phase 1: Foundational Knowledge (3-9 months)</strong><i class="fas fa-plus accordion-icon"></i></div>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Mathematics:</strong> Linear Algebra (Vectors, Matrices, Eigenvalues/vectors), Calculus (Derivatives, Gradients, Integrals), Probability & Statistics (Distributions, Hypothesis Testing, Bayes' Theorem, Regression basics).</li>
                            <li><strong>Programming:</strong> Python (Core syntax, data structures, functions, classes, OOP basics), NumPy (Numerical computation), Pandas (Data manipulation).</li>
                            <li><strong>Computer Science Basics:</strong> Data Structures & Algorithms, Version Control (Git/GitHub).</li>
                            <li><strong>Intro to Data Visualization:</strong> Matplotlib, Seaborn for basic plotting.</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <div class="accordion-header"><strong>Phase 2: Core Machine Learning (6-12 months)</strong><i class="fas fa-plus accordion-icon"></i></div>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Machine Learning Concepts:</strong> Supervised Learning (Regression, Classification), Unsupervised Learning (Clustering, Dimensionality Reduction), Model Evaluation Metrics (Accuracy, Precision, Recall, F1, ROC/AUC, MSE, MAE), Bias-Variance Tradeoff, Overfitting/Underfitting, Cross-Validation.</li>
                            <li><strong>Data Preprocessing & Feature Engineering:</strong> Handling Missing Data, Outlier Detection, Data Scaling & Normalization, Categorical Encoding, Feature Selection & Extraction (PCA, t-SNE), Exploratory Data Analysis (EDA).</li>
                            <li><strong>Traditional ML Algorithms:</strong> Linear/Logistic Regression, Decision Trees, Random Forests, Gradient Boosting Machines (XGBoost, LightGBM), Support Vector Machines (SVM), K-Means Clustering, K-Nearest Neighbors (KNN).</li>
                            <li><strong>Key Libraries:</strong> Scikit-learn.</li>
                            <li><strong>Practical Projects:</strong> Start working on small datasets (e.g., from Kaggle, UCI ML Repository).</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <div class="accordion-header"><strong>Phase 3: Deep Learning & Specialization (9-18+ months)</strong><i class="fas fa-plus accordion-icon"></i></div>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Deep Learning Fundamentals:</strong> Neural Networks Basics (Neurons, Layers, Activation Functions, Backpropagation), Convolutional Neural Networks (CNNs), Recurrent Neural Networks (RNNs, LSTMs, GRUs), Optimizers, Loss Functions, Regularization (Dropout), Transfer Learning.</li>
                            <li><strong>Deep Learning Frameworks:</strong> TensorFlow (with Keras), PyTorch.</li>
                            <li><strong>Specializations:</strong> Natural Language Processing (NLP - Text Preprocessing, Word Embeddings, Transformers like BERT/GPT), Computer Vision (CV - Image Classification, Object Detection, Segmentation), Reinforcement Learning (RL).</li>
                            <li><strong>MLOps (Machine Learning Operations):</strong> Model Deployment (Flask/Django APIs, Docker, Kubernetes), Model Monitoring, Versioning (DVC, MLflow), CI/CD, Cloud ML Platforms (AWS SageMaker, Google AI Platform, Azure ML).</li>
                        </ul>
                    </div>
                </div>
                 <div class="accordion-item">
                    <div class="accordion-header"><strong>Phase 4: Advanced Practice & Research (Ongoing)</strong><i class="fas fa-plus accordion-icon"></i></div>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Advanced Topics:</strong> Generative AI, Explainable AI (XAI), Federated Learning, Quantum ML, Graph Neural Networks.</li>
                            <li><strong>Research & Innovation:</strong> Reading and implementing research papers, contributing to open source.</li>
                            <li><strong>Large-Scale Projects & Domain Expertise.</strong></li>
                            <li><strong>Ethics in AI:</strong> Understanding bias, fairness, and societal impact.</li>
                            <li><span class="soft-skill-text"><strong>Mentorship & Leadership.</strong></span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section class="content-section" id="certifications-courses">
            <h3>Notable Courses & Certifications</h3>
            <p>Focus on hands-on projects and understanding; courses supplement this.</p>
            <ul>
                <li><strong>Foundational:</strong> Andrew Ng's Machine Learning Specialization (Coursera), DeepLearning.AI TensorFlow Developer Professional Certificate, Mathematics for Machine Learning Specialization (Coursera), Fast.ai Courses.</li>
                <li><strong>Platform-Specific:</strong> Google Cloud Professional Machine Learning Engineer, AWS Certified Machine Learning - Specialty, Microsoft Certified: Azure AI Engineer/Data Scientist Associate.</li>
                <li><strong>Specialized:</strong> Stanford CS224N (NLP), Stanford CS231n (CV), DeepMind x UCL Reinforcement Learning Lectures.</li>
            </ul>
        </section>

        <section class="content-section" id="soft-skills">
            <h3>Crucial Soft Skills for ML</h3>
            <ul>
                <li><span class="soft-skill-text"><strong>Problem Solving & Analytical Thinking</strong></span></li>
                <li><span class="soft-skill-text"><strong>Statistical Intuition & Data Sense</strong></span></li>
                <li><span class="soft-skill-text"><strong>Communication (Written & Verbal)</strong></span></li>
                <li><span class="soft-skill-text"><strong>Continuous Learning & Curiosity</strong></span></li>
                <li><span class="soft-skill-text"><strong>Attention to Detail & Rigor</strong></span></li>
                <li><span class="soft-skill-text"><strong>Experimentation Mindset</strong></span></li>
                <li><span class="soft-skill-text"><strong>Business Acumen</strong></span></li>
                <li><span class="soft-skill-text"><strong>Ethical Awareness</strong></span></li>
            </ul>
        </section>

        <section class="content-section" id="learning-resources">
            <h3>Recommended Learning Resources</h3>
            <ul>
                <li><span class="resource-text"><strong>Platforms & Competitions:</strong> Kaggle, Zindi.</span></li>
                <li><span class="resource-text"><strong>Online Courses:</strong> Coursera, edX, Udacity, DataCamp, Fast.ai, DeepLearning.AI.</span></li>
                <li><span class="resource-text"><strong>Books:</strong> "Hands-On Machine Learning" (Géron), "Pattern Recognition and Machine Learning" (Bishop), "Deep Learning" (Goodfellow et al.).</span></li>
                <li><span class="resource-text"><strong>Documentation:</strong> Scikit-learn, TensorFlow, PyTorch, Pandas, NumPy.</span></li>
                <li><span class="resource-text"><strong>Research Papers:</strong> ArXiv (cs.LG, cs.AI, stat.ML), PapersWithCode.</span></li>
                <li><span class="resource-text"><strong>Blogs & Communities:</strong> Towards Data Science, KDnuggets, Distill.pub, Reddit (r/MachineLearning, r/datascience).</span></li>
            </ul>
        </section>
        
        <div id="graph-tooltip"></div> <!-- Custom Tooltip Element -->
    </div>

    <script>
        const darkModeToggle = document.getElementById('darkModeToggle');
        const modeIcon = document.getElementById('modeIcon');
        const getCssVar = (name) => getComputedStyle(document.documentElement).getPropertyValue(name).trim();

        function applyTheme() {
            if (darkModeToggle.checked) {
                document.documentElement.classList.add('dark-mode');
                modeIcon.classList.remove('fa-moon'); modeIcon.classList.add('fa-sun');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.classList.remove('dark-mode');
                modeIcon.classList.remove('fa-sun'); modeIcon.classList.add('fa-moon');
                localStorage.setItem('theme', 'light');
            }
            const graphContainer = document.getElementById('visNetwork');
            const customTooltip = document.getElementById('graph-tooltip');

            if (graphContainer) {
                graphContainer.style.border = `1px solid ${getCssVar('--border-glass-current')}`;
            }
            if (customTooltip) { // Update tooltip border if it exists
                customTooltip.style.background = getCssVar('--bg-glass-current');
                customTooltip.style.color = getCssVar('--text-primary-current');
                customTooltip.style.boxShadow = getCssVar('--shadow-current');
                customTooltip.style.border = `1px solid ${getCssVar('--border-glass-current')}`;
                // For #graph-tooltip strong color, it's handled by CSS vars directly.
            }

            if(Graph) { 
                Graph.backgroundColor(darkModeToggle.checked ? getCssVar('--bg-dark') : getCssVar('--bg-light'));
                Graph.scene().children.find(c => c instanceof THREE.AmbientLight)?.color.setHex(darkModeToggle.checked ? 0x666666 : 0xaaaaaa);
                Graph.graphData().nodes.forEach(node => {
                    if (node.__threeObj) {
                        const labelSprite = node.__threeObj.children.find(child => child.name === 'labelSprite');
                        if (labelSprite) { 
                            node.__threeObj.remove(labelSprite); 
                            const newLabel = createTextLabel(node.name || node.id, node.color); 
                            const labelOffset = (node.shape === 'cone' ? (node.size * 0.9) : (node.size * 0.6)) + 3;
                            newLabel.position.set(0, labelOffset, 0);
                            node.__threeObj.add(newLabel); 
                        }
                    }
                });
                updateNodeVisuals(); 
            }
        }
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') { darkModeToggle.checked = true; }

        const DEFAULT_NODE_OPACITY = 0.85;
        const SELECTED_NODE_OPACITY = 1.0; 
        const NEIGHBOR_NODE_OPACITY = 0.9; 
        const DIMMED_NODE_OPACITY = 0.08; 
        const DEFAULT_LABEL_OPACITY = 0.7;
        const SELECTED_LABEL_OPACITY = 0.95; 
        const NEIGHBOR_LABEL_OPACITY = 0.85; 
        const DIMMED_LABEL_OPACITY = 0.05;
        const DEFAULT_LINK_OPACITY = 0.15;
        const SELECTED_LINK_OPACITY = 0.7; 
        const DIMMED_LINK_OPACITY = 0.02;

        let Graph; 
        let currentSelectedNodeData = null;
        let highlightedNodesSet = new Set();
        let highlightedLinksSet = new Set();
        let rawData; 

        const feynmanExplanations = {
            'Foundations': "Imagine building a giant LEGO castle! Before you build the cool towers (that's Machine Learning), you need a strong base and know how to connect the LEGO bricks. 'Foundations' are these essential starting pieces: knowing some 'Mathematics' (like counting and shapes), 'Programming' (how to give instructions), and basic 'Computer Science' (how computers organize things).",
            'Mathematics': "Think of math as a giant toolbox for solving puzzles. For Machine Learning, important tools are:<br><b>Linear Algebra</b>: Playing with lists of numbers and arrows (great for organizing data).<br><b>Calculus</b>: Understanding how things change (like a model getting better at predictions).<br><b>Probability & Stats</b>: Making smart guesses and finding patterns in data (like figuring out if a coin is fair).",
            'Programming': "This is like learning a special language to give instructions to a computer. For Machine Learning, 'Python' is a very popular choice because it's like a friendly helper that's easy to learn and has lots of pre-built tools.",
            'CS Basics': "Think of this as learning the 'ABCs' of how computers work and organize information. This includes 'Data Structures' (like different ways to store your LEGOs) and 'Algorithms' (step-by-step recipes to solve problems). 'Git/GitHub' is like a magic 'undo' button and a way to share your LEGO creations with others.",
            'Linear Algebra': "Imagine you have grids of numbers (matrices) or arrows (vectors). Linear Algebra is like a set of rules for squishing, stretching, or combining these grids and arrows. It's super important for how computers handle and 'see' data in ML.",
            'Calculus': "Calculus is all about change! If something is moving, growing, or getting better (like an ML model learning), calculus helps us measure *how fast* it's changing (derivatives) or how much it has changed overall (integrals). It’s like a super-magnifying glass for change.",
            'Probability & Stats': "Probability is like guessing games: what are the chances it rains? Statistics helps us collect clues (data), organize them, and use them to make smart guesses or find hidden stories in the numbers. It's key to knowing if our ML models are actually learning well.",
            'Python': "Python is a popular language for talking to computers. It's like English, but for machines! It's loved because it's easy to read, write, and has tons of ready-made tools (libraries) for building cool things, especially in Machine Learning.",
            'NumPy': "Imagine you have LOTS of numbers you need to work with, like a giant spreadsheet. NumPy is a special Python tool that's super fast at doing math with big lists or grids of numbers. It's like a power-drill for number crunching.",
            'Pandas': "Pandas is another Python tool, perfect for working with data tables (like Excel spreadsheets, but in code!). It helps you clean up messy data, organize it, and ask questions like 'What's the average age?'. It's like a super-organizer for your data.",
            'Git/GitHub': "Git is like a time machine for your code. If you make a mistake, you can go back! GitHub is like a website where you can store your code projects online, share them with others, and work together on big projects. It's essential for teamwork.",
            'Matplotlib/Seaborn': "These are Python tools for drawing pictures with your data! Instead of just looking at numbers, you can create charts and graphs to see patterns, trends, or how things are related. It's like making your data tell a visual story.",
            'Scikit-learn': "This is a treasure chest of ready-to-use Machine Learning tools in Python. Need to predict something? Classify items? Find groups? Scikit-learn has algorithms for all that, making it much easier to build ML models without starting from scratch.",
            'Data Science Core': "This is the heart of working with data. It's about asking good questions, finding data (Data Collection), exploring it to see what's interesting (EDA), cleaning it up (Data Preprocessing), and cleverly preparing it for ML models (Feature Engineering).",
            'EDA': "Exploratory Data Analysis (EDA) is like being a detective with your data. You look for clues, ask questions, make charts, and try to understand the story your data is trying to tell you *before* you build any fancy models.",
            'Data Preprocessing': "Imagine your data is like a messy room. Preprocessing is cleaning it up! This means filling in missing pieces, fixing errors, and getting everything organized so your Machine Learning models can work with it properly.",
            'Feature Engineering': "This is like being a clever inventor for your data. You take the raw data you have and create new, smarter 'features' (or signals) that help your Machine Learning models learn better and make more accurate predictions. It's a bit of an art!",
            'Core ML Concepts': "These are the big ideas behind Machine Learning. It's about understanding how computers can learn from examples (Supervised/Unsupervised Learning) and how we can check if they're actually learning the right things (Model Evaluation).",
            'Supervised Learning': "Imagine teaching a child by showing examples with labels. 'This is a cat,' 'This is a dog.' Supervised Learning is similar: you give the computer data with answers, and it learns to predict answers for new, unseen data. It's used for tasks like predicting house prices or identifying spam emails.",
            'Unsupervised Learning': "What if you have data without any labels or answers? Unsupervised Learning is like asking the computer to find interesting patterns or groups in the data all by itself. Think of it like sorting a mixed bag of LEGOs into piles of similar bricks without being told what the piles should be.",
            'Model Evaluation': "After you build an ML model (your 'student'), how do you know if it's any good? Model Evaluation is like giving your student a test! You use different scores (metrics) to see how well it performs and if it's truly learned or just memorized.",
            'Deep Learning': "Think of this as a special type of Machine Learning that's inspired by how our brains work, using 'neural networks' (like many tiny, connected brain cells). It's super powerful for complex tasks like understanding images, speech, or text, especially when you have LOTS of data.",
            'Neural Networks': "These are the 'brains' of Deep Learning. Imagine many simple calculators (neurons) connected in layers. Each one does a small calculation, and by working together, they can learn very complex patterns from data, like recognizing a face in a photo.",
            'CNNs': "Convolutional Neural Networks (CNNs) are a type of neural network that's a superstar at understanding images. They work by scanning pictures bit by bit, looking for simple patterns (like edges or corners) and then combining these to recognize more complex things (like eyes, then faces, then a whole cat!).",
            'RNNs/LSTMs': "Recurrent Neural Networks (RNNs) are special because they have 'memory'. This makes them great for things that happen in order, like words in a sentence or notes in a song. LSTMs are an advanced type of RNN that are even better at remembering things for a long time.",
            'Transformers': "Transformers are a newer, super-powerful type of model, especially famous in understanding language (like GPT, which powers ChatGPT). They are very good at paying 'attention' to the most important parts of the input, like which words in a sentence are most relevant to each other.",
            'NLP': "Natural Language Processing (NLP) is about teaching computers to understand and use human language – reading, writing, speaking. Think of Siri, Google Translate, or chatbots. It's like giving computers the ability to have a conversation.",
            'Computer Vision': "This is like giving eyes to computers! Computer Vision teaches machines to 'see' and interpret images and videos – recognizing objects, faces, scenes, or even understanding what's happening in a video. Self-driving cars use this a lot!",
            'Reinforcement Learning': "Imagine training a dog with treats. Reinforcement Learning is similar: you teach an 'agent' (like a robot or a game character) by giving it 'rewards' for good actions and 'penalties' for bad ones. It learns by trial and error to achieve a goal, like winning a game.",
            'MLOps': "Machine Learning Operations (MLOps) is like being the expert mechanic and manager for your ML models. It's about all the steps to take a model from an idea to being used in the real world reliably – deploying it, keeping an eye on it, and updating it when needed. It's about making ML professional and scalable."
        };

        let customTooltipElement; // Will hold the #graph-tooltip div
        let graphContainerForMouseEvents; // Will hold the #visNetwork div

        document.addEventListener('DOMContentLoaded', () => {
            customTooltipElement = document.getElementById('graph-tooltip');
            graphContainerForMouseEvents = document.getElementById('visNetwork');

            applyTheme(); 
            darkModeToggle.addEventListener('change', applyTheme);

            const accordions = document.querySelectorAll('.accordion-item');
            accordions.forEach(accordion => {
                const header = accordion.querySelector('.accordion-header');
                header.addEventListener('click', () => {
                    const isActive = accordion.classList.contains('active');
                    accordions.forEach(acc => {
                         if (acc !== accordion) { 
                            acc.classList.remove('active');
                            acc.querySelector('.accordion-content').style.maxHeight = "0px"; 
                         }
                    });
                    if (!isActive) {
                        accordion.classList.add('active');
                        const content = accordion.querySelector('.accordion-content');
                        content.style.maxHeight = content.scrollHeight + "px";
                    } else {
                        accordion.classList.remove('active');
                        const content = accordion.querySelector('.accordion-content');
                        content.style.maxHeight = "0px";
                    }
                });
            });

            if (graphContainerForMouseEvents) {
                graphContainerForMouseEvents.addEventListener('mousemove', event => {
                    if (customTooltipElement && customTooltipElement.style.display === 'block') {
                        let x = event.clientX + 15; // Relative to viewport
                        let y = event.clientY + 15; // Relative to viewport

                        const tooltipRect = customTooltipElement.getBoundingClientRect();
                        const viewportWidth = window.innerWidth;
                        const viewportHeight = window.innerHeight;

                        if (x + tooltipRect.width > viewportWidth) {
                            x = event.clientX - tooltipRect.width - 15;
                        }
                        if (y + tooltipRect.height > viewportHeight) {
                            y = event.clientY - tooltipRect.height - 15;
                        }
                        if (x < 0) x = 5; // Add small padding from edge
                        if (y < 0) y = 5; // Add small padding from edge
                        
                        customTooltipElement.style.left = `${x}px`;
                        customTooltipElement.style.top = `${y}px`;
                    }
                });
            }


            function attemptInitGraph(retries = 5, delay = 300) {
                const graphContainer = document.getElementById('visNetwork'); // Already used this name
                const loadingMessageElement = graphContainer.querySelector('.loading-message'); // Assuming it exists
                if (typeof THREE !== 'undefined' && typeof ForceGraph3D !== 'undefined') {
                    if (loadingMessageElement) loadingMessageElement.textContent = "Libraries loaded. Initializing 3D Graph...";
                    initNewGraph();
                } else {
                    if (loadingMessageElement) loadingMessageElement.innerHTML = `Waiting for 3D Graph Libraries... Retrying... (${retries} left)`;
                    if (retries > 0) { setTimeout(() => attemptInitGraph(retries - 1, delay), delay); }
                    else if (loadingMessageElement) {
                        loadingMessageElement.innerHTML = "Error: Failed to load 3D graph components. Refresh or check console.";
                        loadingMessageElement.style.color = "red";
                    }
                }
            }
            attemptInitGraph();
        });


        function initNewGraph() {
            const graphContainer = document.getElementById('visNetwork'); // For ForceGraph3D init
            const loadingMessageElement = graphContainer.querySelector('.loading-message');
            if (loadingMessageElement) loadingMessageElement.style.display = 'none';

            CanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) {
                if (w < 2 * r) r = w / 2; if (h < 2 * r) r = h / 2;
                this.beginPath(); this.moveTo(x + r, y);
                this.arcTo(x + w, y, x + w, y + h, r); this.arcTo(x + w, y + h, x, y + h, r);
                this.arcTo(x, y + h, x, y, r); this.arcTo(x, y, x + w, y, r);
                this.closePath(); return this;
            };
            
            const nodeColors = {
                Foundations: '#A0D2DB', Mathematics: '#F7C8E0', 'Data Science Core': '#BEE1E6',
                'Core ML Models': '#A9DFBF', 'Deep Learning': '#D4A0F9', NLP: '#FFB347',
                'Computer Vision': '#87CEEB', 'Reinforcement Learning': '#FFDAB9', MLOps: '#FEC89A',
                'Tools & Libraries': '#B2BABB', 'Courses/Certs': '#E0BBE4', 'General Concepts': '#C7CEEA',
                Specialization: '#f7a1a0' 
            };

            rawData = { 
                nodes: [
                    { id: 'Foundations', name: 'Foundations', group: 'Foundations', color: nodeColors.Foundations, shape: 'capsule', size: 12 },
                    { id: 'Mathematics', name: 'Mathematics', group: 'Mathematics', color: nodeColors.Mathematics, shape: 'sphere', size: 10 },
                    { id: 'Programming', name: 'Programming', group: 'Foundations', color: nodeColors.Foundations, shape: 'capsule', size: 9 },
                    { id: 'CS Basics', name: 'CS Basics', group: 'Foundations', color: nodeColors.Foundations, shape: 'capsule', size: 7 },
                    { id: 'Linear Algebra', name: 'Linear Algebra', group: 'Mathematics', color: nodeColors.Mathematics, shape: 'cube', size: 7 },
                    { id: 'Calculus', name: 'Calculus', group: 'Mathematics', color: nodeColors.Mathematics, shape: 'cube', size: 7 },
                    { id: 'Probability & Stats', name: 'Probability & Stats', group: 'Mathematics', color: nodeColors.Mathematics, shape: 'cube', size: 8 },
                    { id: 'Python', name: 'Python', group: 'Tools & Libraries', color: nodeColors['Tools & Libraries'], shape: 'cylinder', size: 7 },
                    { id: 'NumPy', name: 'NumPy', group: 'Tools & Libraries', color: nodeColors['Tools & Libraries'], shape: 'cylinder', size: 6 },
                    { id: 'Pandas', name: 'Pandas', group: 'Tools & Libraries', color: nodeColors['Tools & Libraries'], shape: 'cylinder', size: 6 },
                    { id: 'Git/GitHub', name: 'Git/GitHub', group: 'Tools & Libraries', color: nodeColors['Tools & Libraries'], shape: 'cylinder', size: 5 },
                    { id: 'Matplotlib/Seaborn', name: 'Matplotlib/Seaborn', group: 'Tools & Libraries', color: nodeColors['Tools & Libraries'], shape: 'cylinder', size: 5 },
                    { id: 'Scikit-learn', name: 'Scikit-learn', group: 'Tools & Libraries', color: nodeColors['Tools & Libraries'], shape: 'cylinder', size: 7 },
                    { id: 'Data Science Core', name: 'Data Science Core', group: 'Data Science Core', color: nodeColors['Data Science Core'], shape: 'sphere', size: 10 },
                    { id: 'Data Collection', name: 'Data Collection', group: 'Data Science Core', color: nodeColors['Data Science Core'], shape: 'cube', size: 6 },
                    { id: 'EDA', name: 'Exploratory Data Analysis (EDA)', group: 'Data Science Core', color: nodeColors['Data Science Core'], shape: 'cube', size: 7 },
                    { id: 'Data Preprocessing', name: 'Data Preprocessing', group: 'Data Science Core', color: nodeColors['Data Science Core'], shape: 'cube', size: 8 },
                    { id: 'Feature Engineering', name: 'Feature Engineering', group: 'Data Science Core', color: nodeColors['Data Science Core'], shape: 'cube', size: 7 },
                    { id: 'Core ML Concepts', name: 'Core ML Concepts', group: 'Core ML Models', color: nodeColors['Core ML Models'], shape: 'sphere', size: 10 },
                    { id: 'Supervised Learning', name: 'Supervised Learning', group: 'Core ML Models', color: nodeColors['Core ML Models'], shape: 'capsule', size: 7 },
                    { id: 'Unsupervised Learning', name: 'Unsupervised Learning', group: 'Core ML Models', color: nodeColors['Core ML Models'], shape: 'capsule', size: 7 },
                    { id: 'Model Evaluation', name: 'Model Evaluation & Validation', group: 'Core ML Models', color: nodeColors['Core ML Models'], shape: 'cone', size: 8 },
                    { id: 'Linear Models', name: 'Linear Models (Regression, Logistic)', group: 'Core ML Models', color: nodeColors['Core ML Models'], shape: 'cube', size: 6 },
                    { id: 'Tree-based Models', name: 'Tree-based Models (DT, RF, GBM)', group: 'Core ML Models', color: nodeColors['Core ML Models'], shape: 'cube', size: 7 },
                    { id: 'SVM', name: 'Support Vector Machines (SVM)', group: 'Core ML Models', color: nodeColors['Core ML Models'], shape: 'cube', size: 6 },
                    { id: 'Clustering Algos', name: 'Clustering (K-Means, Hierarchical)', group: 'Core ML Models', color: nodeColors['Core ML Models'], shape: 'cube', size: 6 },
                    { id: 'Deep Learning', name: 'Deep Learning', group: 'Deep Learning', color: nodeColors['Deep Learning'], shape: 'sphere', size: 10 },
                    { id: 'Neural Networks', name: 'Neural Networks Basics', group: 'Deep Learning', color: nodeColors['Deep Learning'], shape: 'capsule', size: 8 },
                    { id: 'CNNs', name: 'Convolutional Neural Networks (CNNs)', group: 'Deep Learning', color: nodeColors['Deep Learning'], shape: 'cube', size: 7 },
                    { id: 'RNNs/LSTMs', name: 'RNNs/LSTMs/GRUs', group: 'Deep Learning', color: nodeColors['Deep Learning'], shape: 'cube', size: 7 },
                    { id: 'Transformers', name: 'Transformers (BERT, GPT)', group: 'Deep Learning', color: nodeColors['Deep Learning'], shape: 'dodecahedron', size: 7 },
                    { id: 'TensorFlow/Keras', name: 'TensorFlow / Keras', group: 'Tools & Libraries', color: nodeColors['Tools & Libraries'], shape: 'cylinder', size: 7 },
                    { id: 'PyTorch', name: 'PyTorch', group: 'Tools & Libraries', color: nodeColors['Tools & Libraries'], shape: 'cylinder', size: 7 },
                    { id: 'Specializations', name: 'Specializations', group: 'Specialization', color: nodeColors.Specialization, shape: 'sphere', size: 10 },
                    { id: 'NLP', name: 'Natural Language Processing (NLP)', group: 'NLP', color: nodeColors.NLP, shape: 'dodecahedron', size: 9 },
                    { id: 'Computer Vision', name: 'Computer Vision (CV)', group: 'Computer Vision', color: nodeColors['Computer Vision'], shape: 'dodecahedron', size: 9 },
                    { id: 'Reinforcement Learning', name: 'Reinforcement Learning (RL)', group: 'Reinforcement Learning', color: nodeColors['Reinforcement Learning'], shape: 'dodecahedron', size: 9 },
                    { id: 'Time Series', name: 'Time Series Analysis', group: 'Specialization', color: nodeColors.Specialization, shape: 'cone', size: 7 },
                    { id: 'Recommender Systems', name: 'Recommender Systems', group: 'Specialization', color: nodeColors.Specialization, shape: 'cone', size: 7 },
                    { id: 'MLOps', name: 'MLOps', group: 'MLOps', color: nodeColors.MLOps, shape: 'sphere', size: 9 },
                    { id: 'Model Deployment', name: 'Model Deployment', group: 'MLOps', color: nodeColors.MLOps, shape: 'cube', size: 7 },
                    { id: 'Model Monitoring', name: 'Model Monitoring & Versioning', group: 'MLOps', color: nodeColors.MLOps, shape: 'cube', size: 7 },
                    { id: 'Cloud ML Platforms', name: 'Cloud ML Platforms (AWS, GCP, Azure)', group: 'MLOps', color: nodeColors.MLOps, shape: 'capsule', size: 7 },
                    { id: 'Docker/Kubernetes', name: 'Docker/Kubernetes for ML', group: 'Tools & Libraries', color: nodeColors['Tools & Libraries'], shape: 'cylinder', size: 6 },
                    { id: 'Ethics in AI', name: 'Ethics in AI', group: 'General Concepts', color: nodeColors['General Concepts'], shape: 'capsule', size: 7 },
                    { id: 'Courses/Certs', name: 'Courses/Certs', group: 'Courses/Certs', color: nodeColors['Courses/Certs'], shape: 'sphere', size: 8 },
                ],
                links: [ 
                    { source: 'Foundations', target: 'Mathematics' }, { source: 'Foundations', target: 'Programming' }, { source: 'Foundations', target: 'CS Basics' },
                    { source: 'Mathematics', target: 'Linear Algebra' }, { source: 'Mathematics', target: 'Calculus' }, { source: 'Mathematics', target: 'Probability & Stats' },
                    { source: 'Programming', target: 'Python' }, { source: 'Python', target: 'NumPy' }, { source: 'Python', target: 'Pandas' },
                    { source: 'CS Basics', target: 'Git/GitHub' }, { source: 'Foundations', target: 'Data Science Core' },
                    { source: 'Data Science Core', target: 'Data Collection' }, { source: 'Data Science Core', target: 'EDA' }, { source: 'EDA', target: 'Matplotlib/Seaborn' },
                    { source: 'Data Science Core', target: 'Data Preprocessing' }, { source: 'Data Science Core', target: 'Feature Engineering' },
                    { source: 'Pandas', target: 'EDA' }, { source: 'Pandas', target: 'Data Preprocessing' }, { source: 'Data Science Core', target: 'Core ML Concepts' },
                    { source: 'Core ML Concepts', target: 'Supervised Learning' }, { source: 'Core ML Concepts', target: 'Unsupervised Learning' },
                    { source: 'Core ML Concepts', target: 'Model Evaluation' }, { source: 'Core ML Concepts', target: 'Scikit-learn' },
                    { source: 'Supervised Learning', target: 'Linear Models' }, { source: 'Supervised Learning', target: 'Tree-based Models' }, { source: 'Supervised Learning', target: 'SVM' },
                    { source: 'Unsupervised Learning', target: 'Clustering Algos' }, { source: 'Probability & Stats', target: 'Core ML Concepts' }, 
                    { source: 'Linear Algebra', target: 'Core ML Concepts' }, { source: 'Core ML Concepts', target: 'Deep Learning' },
                    { source: 'Deep Learning', target: 'Neural Networks' }, { source: 'Neural Networks', target: 'Calculus' },
                    { source: 'Deep Learning', target: 'CNNs' }, { source: 'Deep Learning', target: 'RNNs/LSTMs' }, { source: 'Deep Learning', target: 'Transformers' },
                    { source: 'Deep Learning', target: 'TensorFlow/Keras' }, { source: 'Deep Learning', target: 'PyTorch' }, { source: 'Deep Learning', target: 'Specializations' },
                    { source: 'Specializations', target: 'NLP' }, { source: 'Specializations', target: 'Computer Vision' }, { source: 'Specializations', target: 'Reinforcement Learning' },
                    { source: 'Specializations', target: 'Time Series' }, { source: 'Specializations', target: 'Recommender Systems' },
                    { source: 'CNNs', target: 'Computer Vision' }, { source: 'RNNs/LSTMs', target: 'NLP' }, { source: 'Transformers', target: 'NLP' },
                    { source: 'Core ML Concepts', target: 'MLOps' }, { source: 'Deep Learning', target: 'MLOps' },
                    { source: 'MLOps', target: 'Model Deployment' }, { source: 'MLOps', target: 'Model Monitoring' }, { source: 'MLOps', target: 'Cloud ML Platforms' },
                    { source: 'Model Deployment', target: 'Docker/Kubernetes' }, { source: 'Foundations', target: 'Ethics in AI' }, 
                    { source: 'Specializations', target: 'Ethics in AI' }, { source: 'Foundations', target: 'Courses/Certs' }, 
                    { source: 'Core ML Concepts', target: 'Courses/Certs' }, { source: 'Deep Learning', target: 'Courses/Certs' }
                ]
            };
            rawData.links.forEach((link, i) => link.id = `link-${i}`);


            function createTextLabel(text, nodeColor) {
                const fontSize = 20; const padding = 10;
                const canvas = document.createElement('canvas'); const ctx = canvas.getContext('2d');
                ctx.font = `600 ${fontSize}px Poppins, Arial, sans-serif`;
                const textMetrics = ctx.measureText(text); const textWidth = textMetrics.width;
                const width = textWidth + padding * 2; const height = fontSize + padding * 1.5;
                canvas.width = width * 2; canvas.height = height * 2; ctx.scale(2, 2);
                ctx.fillStyle = darkModeToggle.checked ? 'rgba(50, 55, 60, 0.7)' : 'rgba(250, 250, 255, 0.7)';
                ctx.roundRect(0, 0, width, height, 8); ctx.fill();
                ctx.fillStyle = darkModeToggle.checked ? '#F0F0F0' : '#222222';
                ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
                ctx.fillText(text, width / 2, height / 2);
                const texture = new THREE.CanvasTexture(canvas); texture.minFilter = THREE.LinearFilter; texture.needsUpdate = true;
                const material = new THREE.SpriteMaterial({ map: texture, depthTest:false, transparent: true, opacity: DEFAULT_LABEL_OPACITY });
                const sprite = new THREE.Sprite(material); sprite.name = 'labelSprite';
                sprite.scale.set(width / 10, height / 10, 1); return sprite;
            }
            
            function createNodeShape(node) {
                let geometry; const size = node.size || 5;
                switch (node.shape) {
                    case 'cube': geometry = new THREE.BoxGeometry(size, size, size); break;
                    case 'cone': geometry = new THREE.ConeGeometry(size / 1.5, size * 1.8, 16); break;
                    case 'cylinder': geometry = new THREE.CylinderGeometry(size*0.7, size*0.7, size*1.5, 16); break;
                    case 'capsule': geometry = new THREE.CapsuleGeometry(size*0.6, size*1.2, 8, 16); break;
                    case 'dodecahedron': geometry = new THREE.DodecahedronGeometry(size*0.8, 0); break;
                    default: geometry = new THREE.SphereGeometry(size, 24, 12); break;
                }
                const material = new THREE.MeshPhongMaterial({ color: node.color || '#cccccc', shininess: 30, transparent: true, opacity: DEFAULT_NODE_OPACITY });
                const mesh = new THREE.Mesh(geometry, material);
                mesh.userData.defaultColor = new THREE.Color(node.color || '#cccccc'); return mesh;
            }

            Graph = ForceGraph3D()
                (graphContainer)
                .graphData(JSON.parse(JSON.stringify(rawData))) 
                .nodeId('id')
                .nodeLabel(() => null) // Disable default tooltip of 3d-force-graph
                .onNodeHover((node, prevNode) => {
                    if (customTooltipElement) {
                        if (node) {
                            const explanation = feynmanExplanations[node.id] || feynmanExplanations[node.name] || "No explanation available for this topic yet.";
                            customTooltipElement.innerHTML = `<strong>${node.name || node.id}</strong><hr style="border-color: var(--border-glass-current); margin: 5px 0;">${explanation}`;
                            customTooltipElement.style.display = 'block';
                             // Position will be updated by mousemove listener
                        } else {
                            customTooltipElement.style.display = 'none';
                        }
                    }
                })
                .nodeThreeObject(node => {
                    const obj = createNodeShape(node);
                    const label = createTextLabel(node.name || node.id, node.color);
                    const labelOffset = (node.shape === 'cone' ? (node.size * 0.9) : (node.size * 0.6)) + 3;
                    label.position.set(0, labelOffset, 0);
                    obj.add(label);
                    node.__threeObj = obj; 
                    obj.visible = true; 
                    label.visible = true;
                    return obj;
                })
                .linkWidth(0.7)
                .linkMaterial(link => { 
                    const isMainHighlightedLink = highlightedLinksSet.has(link.id);
                    let opacity;

                    if (currentSelectedNodeData) {
                        if (isMainHighlightedLink) {
                            opacity = SELECTED_LINK_OPACITY;
                        } else {
                            opacity = DIMMED_LINK_OPACITY;
                        }
                    } else {
                        opacity = DEFAULT_LINK_OPACITY;
                    }

                    const color = isMainHighlightedLink ?
                                  (darkModeToggle.checked ? '#ffa500' : '#ff8c00') :
                                  (darkModeToggle.checked ? 0xaaaaaa : 0x666666);

                    const material = new THREE.MeshBasicMaterial({
                        color: color,
                        transparent: true,
                        opacity: opacity
                    });
                    if (link.__threeObj) link.__threeObj.visible = true;
                    return material;
                })
                .linkColor(link => { 
                    if (highlightedLinksSet.has(link.id)) {
                        return darkModeToggle.checked ? '#ffa500' : '#ff8c00';
                    }
                    return darkModeToggle.checked ? 'rgba(180,180,180,0.1)' : 'rgba(100,100,100,0.15)';
                })
                .linkDirectionalParticles(link => highlightedLinksSet.has(link.id) ? 2 : 0) 
                .linkDirectionalParticleWidth(link => highlightedLinksSet.has(link.id) ? 1.5 : 0.5)
                .linkDirectionalParticleColor(link => highlightedLinksSet.has(link.id) ? (darkModeToggle.checked ? '#FFD700' : '#FFA500') : (darkModeToggle.checked ? '#666666' : '#AAAAAA'))
                .backgroundColor(darkModeToggle.checked ? getCssVar('--bg-dark') : getCssVar('--bg-light'))
                .enableNodeDrag(false) 
                .cooldownTicks(300) 
                .onEngineStop(() => { 
                    Graph.graphData().nodes.forEach(node => { node.fx = node.x; node.fy = node.y; node.fz = node.z; });
                    console.log("Engine stopped, nodes fixed.");
                    Graph.cameraPosition({ x: 0, y: 0, z: 350 }, { x: 0, y: 0, z: 0 }, 1200); 
                })
                .onNodeClick(handleNodeClick)
                .onBackgroundClick(resetSelectionAndCamera);

            Graph.scene().add(new THREE.AmbientLight(darkModeToggle.checked ? 0x666666 : 0xaaaaaa, 0.8));
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.7);
            directionalLight.position.set(60, 100, 150);
            Graph.scene().add(directionalLight);
        }
        
        function resetSelection() {
            if (!Graph) return;
            currentSelectedNodeData = null;
            highlightedNodesSet.clear();
            highlightedLinksSet.clear();
            updateNodeVisuals();
        }

        function resetSelectionAndCamera() {
            resetSelection();
            if (Graph) { 
                 Graph.cameraPosition({ x: 0, y: 0, z: 350 }, { x: 0, y: 0, z: 0 }, 1200);
            }
        }

        function handleNodeClick(node) { 
            if (!Graph) return;

            if (currentSelectedNodeData && currentSelectedNodeData.id === node.id) {
                resetSelection(); 
            } else {
                currentSelectedNodeData = node; 
                highlightedNodesSet.clear();
                highlightedLinksSet.clear();

                highlightedNodesSet.add(node.id); 

                rawData.links.forEach(linkDef => { 
                    const sourceId = typeof linkDef.source === 'string' ? linkDef.source : linkDef.source.id;
                    const targetId = typeof linkDef.target === 'string' ? linkDef.target : linkDef.target.id;
                    
                    if (sourceId === node.id) { 
                        highlightedNodesSet.add(targetId); 
                        highlightedLinksSet.add(linkDef.id); 
                    }
                    else if (targetId === node.id) { 
                         highlightedNodesSet.add(sourceId); 
                         highlightedLinksSet.add(linkDef.id); 
                    }
                });
                updateNodeVisuals();
                focusCameraOnNode(node); 
            }
        }

        function updateNodeVisuals() {
            if (!Graph) return;
            Graph.graphData().nodes.forEach(n => {
                const obj = n.__threeObj;
                if (!obj) return; 
                const material = obj.material;
                const labelSprite = obj.children.find(child => child.name === 'labelSprite');
                
                if (!labelSprite) return; 

                obj.visible = true; 
                labelSprite.visible = true;

                if (currentSelectedNodeData) {
                    if (n.id === currentSelectedNodeData.id) { 
                        material.opacity = SELECTED_NODE_OPACITY;
                        labelSprite.material.opacity = SELECTED_LABEL_OPACITY;
                    } else if (highlightedNodesSet.has(n.id)) { 
                        material.opacity = NEIGHBOR_NODE_OPACITY;
                        labelSprite.material.opacity = NEIGHBOR_LABEL_OPACITY;
                    } else { 
                        material.opacity = DIMMED_NODE_OPACITY;
                        labelSprite.material.opacity = DIMMED_LABEL_OPACITY;
                    }
                } else { 
                    material.opacity = DEFAULT_NODE_OPACITY;
                    labelSprite.material.opacity = DEFAULT_LABEL_OPACITY;
                }
            });
            Graph.linkMaterial(Graph.linkMaterial()); 
            Graph.linkColor(Graph.linkColor());
            Graph.linkDirectionalParticles(Graph.linkDirectionalParticles());
            Graph.linkDirectionalParticleColor(Graph.linkDirectionalParticleColor());
            Graph.linkDirectionalParticleWidth(Graph.linkDirectionalParticleWidth());
        }
        
        function focusCameraOnNode(node) { 
            if (Graph && node && node.__threeObj) {
                let minX = node.x, maxX = node.x, minY = node.y, maxY = node.y, minZ = node.z, maxZ = node.z;
                let count = 1;

                highlightedNodesSet.forEach(nodeId => {
                    if (nodeId === node.id) return; 
                    const neighborNode = Graph.graphData().nodes.find(n => n.id === nodeId);
                    if (neighborNode && typeof neighborNode.x !== 'undefined') { 
                        minX = Math.min(minX, neighborNode.x); maxX = Math.max(maxX, neighborNode.x);
                        minY = Math.min(minY, neighborNode.y); maxY = Math.max(maxY, neighborNode.y);
                        minZ = Math.min(minZ, neighborNode.z); maxZ = Math.max(maxZ, neighborNode.z);
                        count++;
                    }
                });
                
                const center = { x: (minX + maxX) / 2, y: (minY + maxY) / 2, z: (minZ + maxZ) / 2 };
                const range = Math.max(maxX - minX, maxY - minY, maxZ - minZ, node.size * 4 || 20); 
                const distance = range * 1.0 + 80 + (count * 3); 

                const cameraTarget = new THREE.Vector3(center.x, center.y, center.z);
                const cameraPosition = new THREE.Vector3(center.x, center.y + distance * 0.2, center.z + distance);
                Graph.cameraPosition(cameraPosition, cameraTarget, 1000);
            }
        }
    </script>

</body></html>
